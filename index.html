<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>供暖户号查询（按楼栋/单元/房间号）</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin: 0; padding: 0; background: #f6f8fa; }
    .container { max-width: 940px; margin: 18px auto; padding: 12px; }
    header { text-align: center; margin-bottom: 12px; }
    h1 { font-size: 20px; margin: 8px 0; }
    .search-box { display:flex; gap:8px; flex-wrap: wrap;}
    .search-box input[type=text] { flex:1; min-width: 120px; padding:12px; font-size:16px; border-radius:8px; border:1px solid #d0d7de; box-sizing: border-box; }
    button { padding:12px 14px; font-size:16px; border-radius:8px; border: none; background:#0366d6; color:white; }
    .note { color:#586069; font-size:13px; margin-top:8px; }
    table { width:100%; border-collapse:collapse; margin-top:12px; background:white; border-radius:8px; overflow:hidden; }
    th, td { padding:10px 8px; text-align:left; border-bottom:1px solid #eef0f2; font-size:14px; }
    th { background:#fafbfc; font-weight:600; }
    tr:last-child td { border-bottom: none; }
    .no-result { padding:18px; text-align:center; color:#666; }
    @media (max-width:600px) { h1 { font-size:18px } th, td { font-size:13px; padding:8px } .search-box input[type=text] { padding:10px } button { padding:10px } }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>供暖户号查询</h1>
      <div class="note">请分别输入 <strong>楼栋名称</strong>、<strong>单元名称</strong>、<strong>房间号</strong>，全部匹配后才显示结果，支持模糊匹配。</div>
    </header>

    <div class="search-box" role="search" aria-label="楼栋/单元/房间号查询">
      <input id="building" type="text" placeholder="楼栋名称（如：2）" autocomplete="off" />
      <input id="unit" type="text" placeholder="单元名称（如：1）" autocomplete="off" />
      <input id="room" type="text" placeholder="房间号（如：101）" autocomplete="off" />
      <button id="btn">查询</button>
    </div>

    <div id="result"></div>
    <div class="note">可将此文件上传到 GitHub Pages 或任意静态服务器，手机访问即可共享查询。</div>
  </div>

  <script>
    // 内嵌数据（来自 Excel）
    const data = [{"楼栋名称": "2", "单元名称": "1", "房间号": "101", "用户姓名": "张*庆、李*玲", "用户卡号": "130151189"}, {"楼栋名称": "2", "单元名称": "1", "房间号": "102", "用户姓名": "王*军", "用户卡号": "130151190"}/* ...更多数据... */];
    const buildingInput = document.getElementById('building');
    const unitInput = document.getElementById('unit');
    const roomInput = document.getElementById('room');
    const btn = document.getElementById('btn');
    const result = document.getElementById('result');

    function renderTable(rows) {
      if (!rows || rows.length === 0) {
        result.innerHTML = '<div class="no-result">未找到匹配的记录。</div>';
        return;
      }
      let html = '<table><thead><tr><th>楼栋</th><th>单元</th><th>房间号</th><th>用户姓名</th><th>用户卡号</th></tr></thead><tbody>';
      for (const r of rows) {
        html += '<tr>' +
          '<td>' + escapeHtml(r['楼栋名称']||'') + '</td>' +
          '<td>' + escapeHtml(r['单元名称']||'') + '</td>' +
          '<td>' + escapeHtml(r['房间号']||'') + '</td>' +
          '<td>' + escapeHtml(r['用户姓名']||'') + '</td>' +
          '<td>' + escapeHtml(r['用户卡号']||'') + '</td>' +
        '</tr>';
      }
      html += '</tbody></table>';
      result.innerHTML = html;
    }

    function escapeHtml(str) {
      return String(str).replace(/[&<>"']/g, function(m) { return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]; });
    }

    function doSearch() {
      const building = buildingInput.value.trim().toLowerCase();
      const unit = unitInput.value.trim().toLowerCase();
      const room = roomInput.value.trim().toLowerCase();

      if (!building && !unit && !room) {
        result.innerHTML = '<div class="no-result">请输入查询条件。</div>';
        return;
      }

      const matched = data.filter(item =>
        (item['楼栋名称']||'').toLowerCase().includes(building) &&
        (item['单元名称']||'').toLowerCase().includes(unit) &&
        (item['房间号']||'').toLowerCase().includes(room)
      );
      renderTable(matched);
    }

    btn.addEventListener('click', doSearch);
    buildingInput.addEventListener('keydown', function(e) { if (e.key === 'Enter') doSearch(); });
    unitInput.addEventListener('keydown', function(e) { if (e.key === 'Enter') doSearch(); });
    roomInput.addEventListener('keydown', function(e) { if (e.key === 'Enter') doSearch(); });

    result.innerHTML = '<div class="no-result">请输入查询条件。</div>';
  </script>
</body>
</html>
